steps:
  - task: Bash@3
    displayName: 'Setup pipenv'
    inputs:
      targetType: 'inline'
      script: |
        set -eux  # fail on error
        python -m pip install --upgrade pip
        python -m pip install pipenv
        pipenv --python 3

  - task: Bash@3
    displayName: 'Install deps'
    inputs:
      targetType: 'inline'
      workingDirectory: 'presidio-analyzer'
      script: |
        set -eux  # fail on error
        pipenv sync --dev --sequential
        pipenv run pip install https://github.com/explosion/spacy-models/releases/download/en_core_web_lg-3.2.0/en_core_web_lg-3.2.0-py3-none-any.whl

  - template: ./build-python.yml
    parameters:
      SERVICE: 'Analyzer'
      WORKING_FOLDER: 'presidio-analyzer'

